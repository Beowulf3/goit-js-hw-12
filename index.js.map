{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/img/xmark.png","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst PIXABAY_KEY = '51390103-e5f94b12a87f57c9fbe51ad97';\nexport const per_page = 15;\n\nexport async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios('https://pixabay.com/api/', {\n      params: {\n        key: PIXABAY_KEY,\n        q: `${query}`,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nexport const loadMoreBtn = document.querySelector('.load-more-btn');\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\">\n                <div class=\"image-stats\">\n                    <p class=\"img-stat-text\"><span class=\"img-stat-header\">Likes</span> ${likes}</p>\n                    <p class=\"img-stat-text\"><span class=\"img-stat-header\">Views</span> ${views}</p>\n                    <p class=\"img-stat-text\"><span class=\"img-stat-header\">Comments</span> ${comments}</p>\n                    <p class=\"img-stat-text\"><span class=\"img-stat-header\">Downloads</span> ${downloads}</p>\n                </div>\n            </a>\n        </li>\n    `\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  slider.refresh();\n}\n\nlet slider = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('hidden');\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAhUExURfn5+/v7+/n5+0dwTPr6/Pn5+vn5+/r6+vT0+vT09Pr6+69tr8QAAAAKdFJOU4B/fwCfoK8wMDCbJE/NAAAAn0lEQVQY00XQIY7DMBCG0ZHMzEJLzYyiPEW7vLfoEULLSvcirrWKVJ9ywTYNfPrI/BPIY4zREMz7NE3TlgjyFdZGmH+BWxLvwNrEEbilyFdfcLe22Hkk5hdbPFkauXCJJ2qauwNLy+UDtTuR24m51/RBLks7MHdq4hI7j8LyYot69Q0/1h7LeWgJ9ZjQhSPdivBOaydY/h9SCNQxxuj4A4bdSawyd2feAAAAAElFTkSuQmCC\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByQuery, per_page } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  hideLoader,\n  showLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  loadMoreBtn,\n} from './js/render-functions';\nimport xmark from './img/xmark.png';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector(\"input[name='search-text']\");\n\nlet userQuery = '';\nlet pageNumber = 1;\nlet totalPages = 0;\n\nasync function onSearch() {\n  pageNumber = 1;\n  clearGallery();\n  hideLoadMoreButton();\n  if (!input.value.trim()) {\n    iziError('Empty input. Please type images you want ot find!');\n    return;\n  }\n  showLoader();\n  try {\n    const data = await getImagesByQuery(input.value.trim(), pageNumber);\n    if (!data.hits.length) {\n      iziError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    userQuery = input.value.trim();\n    totalPages = Math.ceil(data.totalHits / per_page);\n    createGallery(data.hits);\n    iziToast.success({\n      message: 'This is what was found!',\n      position: 'topLeft',\n      messageSize: 16,\n      messageLineHeight: 24,\n      closeOnEscape: true,\n      closeOnClick: true,\n    });\n    if (pageNumber === totalPages) {\n      return;\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.log(error);\n    iziError('Oops... Something went wrong. Please, try again!');\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function loadMore() {\n  hideLoadMoreButton();\n  pageNumber += 1;\n  showLoader();\n  try {\n    const data = await getImagesByQuery(userQuery, pageNumber);\n    createGallery(data.hits);\n    const card = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n    window.scrollBy({\n      top: card * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    handleError(error);\n  } finally {\n    hideLoader();\n    if (pageNumber === totalPages) {\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: '#0c0c0c',\n        messageSize: 16,\n        messageLineHeight: 24,\n        position: 'bottomCenter',\n        closeOnEscape: true,\n        closeOnClick: true,\n      });\n      hideLoadMoreButton();\n      return;\n    }\n    showLoadMoreButton();\n  }\n}\n\nfunction iziError(msg) {\n  iziToast.error({\n    message: msg,\n    messageColor: '#fafafb',\n    messageSize: 16,\n    messageLineHeight: 24,\n    position: 'topRight',\n    displayMode: 'replace',\n    closeOnEscape: true,\n    closeOnClick: true,\n    iconUrl: xmark,\n    theme: 'dark',\n    backgroundColor: '#ef4040',\n    maxWidth: 432,\n  });\n}\n\nfunction handleError(error) {\n  const status = error.response?.status;\n  switch (status) {\n    case 429:\n      iziError(\"Don't push the horses! Too many requests.\");\n      break;\n    case 401:\n      iziError('Access denied.');\n      break;\n    case 404:\n      iziError('Resource not found');\n      break;\n    default:\n      iziError(`Error ${status || 'unknown'}`);\n  }\n}\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n  onSearch();\n});\n\nloadMoreBtn.addEventListener('click', loadMore);\n"],"names":["PIXABAY_KEY","per_page","getImagesByQuery","query","page","axios","error","gallery","loader","loadMoreBtn","createGallery","images","markup","webformatURL","tags","largeImageURL","likes","views","comments","downloads","slider","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","xmark","form","input","userQuery","pageNumber","totalPages","onSearch","iziError","data","iziToast","loadMore","card","handleError","msg","status","event"],"mappings":"owBACA,MAAMA,EAAc,qCACPC,EAAW,GAEjB,eAAeC,EAAiBC,EAAOC,EAAM,CAClD,GAAI,CAYF,OAXiB,MAAMC,EAAM,2BAA4B,CACvD,OAAQ,CACN,IAAKL,EACL,EAAG,GAAGG,CAAK,GACX,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAAH,CACR,CACA,CAAK,GACe,IAClB,OAASK,EAAO,CACd,MAAMA,CACR,CACF,CClBA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EAClCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,KAAAC,EACA,cAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,4CAEgCJ,CAAa;AAAA,4BAC7BF,CAAY,UAAUC,CAAI;AAAA;AAAA,0FAEoCE,CAAK;AAAA,0FACLC,CAAK;AAAA,6FACFC,CAAQ;AAAA,8FACPC,CAAS;AAAA;AAAA;AAAA;AAAA,KAKvG,EACK,KAAK,EAAE,EACVZ,EAAQ,mBAAmB,YAAaK,CAAM,EAC9CQ,EAAO,QAAO,CAChB,CAEA,IAAIA,EAAS,IAAIC,EAAe,aAAc,CAC5C,aAAc,MACd,gBAAiB,SACjB,aAAc,GAChB,CAAC,EACM,SAASC,GAAe,CAC7Bf,EAAQ,UAAY,EACtB,CAEO,SAASgB,GAAa,CAC3Bf,EAAO,UAAU,OAAO,QAAQ,CAClC,CAEO,SAASgB,GAAa,CAC3BhB,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAEO,SAASiB,GAAqB,CACnChB,EAAY,UAAU,OAAO,QAAQ,CACvC,CAEO,SAASiB,GAAqB,CACnCjB,EAAY,UAAU,IAAI,QAAQ,CACpC,CC5DA,MAAAkB,EAAe,qdCcTC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAQ,SAAS,cAAc,2BAA2B,EAEhE,IAAIC,EAAY,GACZC,EAAa,EACbC,EAAa,EAEjB,eAAeC,GAAW,CAIxB,GAHAF,EAAa,EACbT,EAAY,EACZI,EAAkB,EACd,CAACG,EAAM,MAAM,OAAQ,CACvBK,EAAS,mDAAmD,EAC5D,MACF,CACAX,EAAU,EACV,GAAI,CACF,MAAMY,EAAO,MAAMjC,EAAiB2B,EAAM,MAAM,KAAI,EAAIE,CAAU,EAClE,GAAI,CAACI,EAAK,KAAK,OAAQ,CACrBD,EACE,0EACR,EACM,MACF,CAYA,GAXAJ,EAAYD,EAAM,MAAM,KAAI,EAC5BG,EAAa,KAAK,KAAKG,EAAK,UAAYlC,CAAQ,EAChDS,EAAcyB,EAAK,IAAI,EACvBC,EAAS,QAAQ,CACf,QAAS,0BACT,SAAU,UACV,YAAa,GACb,kBAAmB,GACnB,cAAe,GACf,aAAc,EACpB,CAAK,EACGL,IAAeC,EACjB,OAEAP,EAAkB,CAEtB,OAASnB,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjB4B,EAAS,kDAAkD,CAC7D,QAAC,CACCV,EAAU,CACZ,CACF,CAEA,eAAea,GAAW,CACxBX,EAAkB,EAClBK,GAAc,EACdR,EAAU,EACV,GAAI,CACF,MAAMY,EAAO,MAAMjC,EAAiB4B,EAAWC,CAAU,EACzDrB,EAAcyB,EAAK,IAAI,EACvB,MAAMG,EAAO,SACV,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAO,EACZ,SAAU,QAChB,CAAK,CACH,OAAShC,EAAO,CACdiC,EAAYjC,CAAK,CACnB,QAAC,CAEC,GADAkB,EAAU,EACNO,IAAeC,EAAY,CAC7BI,EAAS,QAAQ,CACf,QAAS,6DACT,aAAc,UACd,YAAa,GACb,kBAAmB,GACnB,SAAU,eACV,cAAe,GACf,aAAc,EACtB,CAAO,EACDV,EAAkB,EAClB,MACF,CACAD,EAAkB,CACpB,CACF,CAEA,SAASS,EAASM,EAAK,CACrBJ,EAAS,MAAM,CACb,QAASI,EACT,aAAc,UACd,YAAa,GACb,kBAAmB,GACnB,SAAU,WACV,YAAa,UACb,cAAe,GACf,aAAc,GACd,QAASb,EACT,MAAO,OACP,gBAAiB,UACjB,SAAU,GACd,CAAG,CACH,CAEA,SAASY,EAAYjC,EAAO,CAC1B,MAAMmC,EAASnC,EAAM,UAAU,OAC/B,OAAQmC,EAAM,CACZ,IAAK,KACHP,EAAS,2CAA2C,EACpD,MACF,IAAK,KACHA,EAAS,gBAAgB,EACzB,MACF,IAAK,KACHA,EAAS,oBAAoB,EAC7B,MACF,QACEA,EAAS,SAASO,GAAU,SAAS,EAAE,CAC7C,CACA,CAEAb,EAAK,iBAAiB,SAAUc,GAAS,CACvCA,EAAM,eAAc,EACpBT,EAAQ,CACV,CAAC,EAEDxB,EAAY,iBAAiB,QAAS4B,CAAQ"}